image: node:6.11.2

pipelines:
  default:
    - step:
        caches:
          - node
        script:
          - npm install
          - npm run lint
  branches:
    development:
      - step:
          caches:
            - node
          script:
            - npm install
            - git clone -b master https://heroku:$HEROKU_API_KEY@git.heroku.com/$HEROKU_DEVELOPMENT_APP_NAME.git build
            - npm run build
            - cd build && ls -la
            - git add --all || true
            - git config user.email "aduyng@gmail.com"
            - git config user.name "Dewey Nguyen"
            - git commit -m "pushed by bitbucket pipelines" || true
            - git push https://heroku:$HEROKU_API_KEY@git.heroku.com/$HEROKU_DEVELOPMENT_APP_NAME.git master --force
    master:
      - step:
          caches:
            - node
          script:
            - npm install
            - npm run lint